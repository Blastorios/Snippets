The field of experimental Biology generates a massive amount of data. One of the data formats is of genetic origin and is constructed from 4 predefined nucleotides.
BAM files use the binary encoding `00`, `01`, `10`, `11` to efficiently store the nucleotides as binary formats. Now, with a small adaptation we can calculate the
difference between 2 strings by adding a single digit: `011`, `101`, `110`, `000`. All distances are `2`, allowing us to measure the difference between 2 strings efficiently.

---

From: 'https://blog.liudaniel.com/n-grams-BK-trees'

With two strings of nucleotides (A, T, C, or G) of length M, we can compute the Hamming distance (how we measure similarity) in exactly O(M)

time. At first it seems unlikely, but can we do better? The answer is actually yes!

Usually, the encoding method for nucleotides is mapping them to binary: 00, 01, 10, and 11. This is the best we can do if we optimize for size. The problem with this encoding is that we cannot easily find the Hamming distance for two arbitrary strings encoded with them. If we optimize for the speed of computing Hamming distance, we can actually get a different set of encodings: 011, 110, 101, 000. The special property of this set of encodings is that the bitwise Hamming distance between each pair of encodings is exactly 2 (try it; count the number of different bits between each pair). This means that we can easily infer the Hamming distance between two strings of nucleotides when they are encoded with that encoding by calculating the bitwise Hamming distance.

The reason why we can get faster than O(M)
Hamming distance computation is because we can pack a bunch of nucleotides into a single 64-bit computer word. In fact, since computing the bitwise Hamming distance is constant-time (XOR + POPCOUNT operations), we can compute the Hamming distance between two 21 nucleotide strings in constant-time! Note that encoding a nucleotide string still takes O(M) time so this is only beneficial if multiple Hamming comparisons are made. By packing a bunch of nucleotides into one computer word, we can also make hashing and other comparison operations constant-time.